function OrangeCPARevenue(){
async function addload(msg,T,TOP,LEFT,classname) { if(T==0) { var el = document.createElement("div");el.id=classname;el.className='diclass';el.setAttribute("style","padding: 10px;background: #000;color: #00ffff;font-weight: bold;position: relative;border: 1px solid #fff;border-radius: 8px;-webkit-box-shadow:0px 3px 5px #464445;-moz-box-shadow:0px 3px 15px #464445;box-shadow:0px 3px 5px #464445;text-align: center;font-size:250%;position:absolute;top:"+TOP+"%;left:"+LEFT+"%;");el.innerHTML = msg;document.body.appendChild(el);} else { var el=document.getElementById(classname);el.innerHTML = msg; } }async function kk(mydate){ addload('Downloading - '+mydate+'<br><progress id="progressid" value="0" max="100" style="background: #000;height: 20px;border-radius: 6px;overflow: hidden;"></progress>',0,10,42,'unblurred') ;let response=await fetch("https://www.ckadmin.com/Extjs.ashx?s=reportconversions", {"headers": {"accept": "*/*","accept-language": "en-US,en;q=0.9","content-type": "application/x-www-form-urlencoded; charset=UTF-8"},"body":"groupBy=&groupDir=ASC&report_view_id=688&report_id=20&paid_only=0&sellable_only=0&event_only=0&eo=&search_ip_addresses=&date_range=yesterday&start_date="+mydate+"&end_date="+mydate+"&offer=&isp=&test=-1&disposition=0&exclude_bot_traffic=0&aff_billing_status=0&adv_billing_status=0&include_cpc_cpm_conversions=1&n=99999&o=last_updated&d=ASC&report_views=Default&search_by_request_id=&disposition_type=&affiliate_tag=76", "method": "POST",});const reader = response.body.getReader();const contentLength = +response.headers.get('Content-Length');let receivedLength = 0;let chunks = [];while(true) {const {done, value} = await reader.read();if (done) {break;}chunks.push(value);receivedLength += value.length;const progress = ((receivedLength / contentLength) * 100).toFixed(2); addload('Downloading - '+mydate+'<br><progress id="progressid" value="'+progress+'" max="100" style="background: #000;height: 20px;border-radius: 6px;overflow: hidden;"></progress><br>'+progress+'%',1,10,42,'unblurred'); } let chunksAll = new Uint8Array(receivedLength); let position = 0;for(let chunk of chunks) { chunksAll.set(chunk, position);position += chunk.length;}let result = new TextDecoder("utf-8").decode(chunksAll);var ll=JSON.parse(result);var hashmap = new Map();var BREV=0;var OREV=0;var OBREV=ll.summary.received;ll.rows.forEach(function(a) { if(a.subid_4 && a.subid_4.match(/(^ISFT|^CY|^BR|^PUB|^OG)/i)){ OREV=OREV+Number(a.received);  if(!hashmap.has(a.subid_4)){hashmap.set(a.subid_4,0)}if(hashmap.has(a.subid_4)){ hashmap.set(a.subid_4,Number(hashmap.get(a.subid_4))+Number(a.received))}} if(a.subid_1 && a.subid_1.match(/^GIFST/i)){BREV=BREV+Number(a.received)}  });var OTHERREV=OBREV-(BREV+OREV);document.getElementById('unblurred').innerHTML=document.getElementById('unblurred').innerHTML+'<br><font color="cyan" size="4">Orange Revenue=</font><font color="White" style="font-weight:bold" size="4">$'+OREV.toFixed(2)+'</font><br><font color="cyan" size="4">Blue Revenue=</font><font color="White" style="font-weight:bold" size="4">$'+BREV.toFixed(2)+'</font><br><font color="cyan" size="4">Total Revenue=</font><font color="White" style="font-weight:bold" size="4">$'+OBREV.toFixed(2)+'</font><br>'; var FINDATA=[];[...hashmap.keys()].forEach(function(a) {FINDATA.push(a+'\t'+hashmap.get(a))});return(FINDATA.join('\n'));}async function ff(){if(window.location.host.contains('ckadmin.com')){var myinputdate=1;var d=new Date();var today = new Date(d.setDate(d.getDate()-myinputdate)); var dd = today.getDate();var mm = today.getMonth()+1;var yyyy = today.getFullYear(); var mydate=mm+'/'+dd+'/'+yyyy;var FINDATA=await kk(mydate);var trev=0;[...FINDATA.split('\n')].forEach(function(a){trev=trev+Number(a.split('\t')[1])});var el=document.getElementById('unblurred');var input=document.createElement('input');input.type='hidden';input.id="inputid";input.value=FINDATA;document.body.getElementsByClassName('diclass')[0].appendChild(input);document.getElementById('unblurred').innerHTML=document.getElementById('unblurred').innerHTML+'<font color="Yellow" size="3" onclick="(async() => { await navigator.clipboard.writeText(document.getElementById('+"'inputid'"+').value)  })();">Copied to Clipboard</font>';try { await navigator.clipboard.writeText(FINDATA);} catch (e) {console.error(e);} console.log(FINDATA);document.addEventListener('keydown', function(event){if(event.key === "Escape"){if(document.getElementById('unblurred').style['visibility']=='hidden'){navigator.clipboard.writeText(FINDATA).then(() => {console.log('sss')});document.getElementById('unblurred').style['visibility']='';document.getElementById('unblurred2').style['visibility']='';} else if(document.getElementById('unblurred').style['visibility']==''){navigator.clipboard.writeText(FINDATA).then(() => {console.log('sss')});document.getElementById('unblurred').style['visibility']='hidden';document.getElementById('unblurred2').style['visibility']='hidden'}}});var CY=0;var ISFT=0;var BR=0; var OG=0; var PUB=0; FINDATA.split('\n').forEach(function(b){if(b.split('\t')[0].match(/^CY/)){CY=CY+Number(b.split('\t')[1])} if(b.split('\t')[0].match(/^ISFT/)){ISFT=ISFT+Number(b.split('\t')[1])}if(b.split('\t')[0].match(/^OG/)){OG=OG+Number(b.split('\t')[1])}if(b.split('\t')[0].match(/^PUB/)){PUB=PUB+Number(b.split('\t')[1])} });addload('<font color="cyan" size="4">Campaigner=</font><font color="White" style="font-weight:bold" size="4">$'+CY.toFixed(2)+'</font><br><font color="cyan" size="4">Infusion=</font><font color="White" style="font-weight:bold" size="4">$'+ISFT.toFixed(2)+'</font><br><font color="cyan" size="4">Ongage=</font><font color="White" style="font-weight:bold" size="4">$'+OG.toFixed(2)+'<font><br><font color="cyan" size="4">Publicator=</font><font color="White" style="font-weight:bold" size="4">$'+PUB.toFixed(2)+'</font>',0,42,46,'unblurred2')  }}ff()
}

function hotmailDSPF(){
var MYDATA=[];var sheet = document.createElement('style');sheet.innerHTML = ".ZtMcN {margin-bottom:-78px}::-webkit-scrollbar{width: 0;}";document.body.appendChild(sheet);
async function addload(msg,T,TOP,LEFT,classname) { if(T==0) { var el = document.createElement("div");el.id=classname;el.className='diclass';el.setAttribute("style","padding: 10px;background: #000;color: #00ffff;font-weight: bold;position: relative;border: 1px solid #fff;border-radius: 8px;-webkit-box-shadow:0px 3px 5px #464445;-moz-box-shadow:0px 3px 15px #464445;box-shadow:0px 3px 5px #464445;text-align: center;overflow-y:scroll;height:620px;overflow-x:hidden;font-size:76%;position:absolute;top:"+TOP+"%;left:"+LEFT+"%;");el.innerHTML = msg;document.body.appendChild(el);} else { var el=document.getElementById(classname);el.innerHTML = msg; } }
const ensureFooIsSet = (selector, limit) => new Promise((resolve, reject) => {let count = 0;(function waitForFoo() {const element = document.querySelector(selector);if (element){ if(element.innerHTML) return resolve(element)};if (limit && count > limit) return false;count += 1;setTimeout(waitForFoo, 50);})();});
const waitForFoo = async (selector, limit) => {const response = await ensureFooIsSet(selector, limit);console.log('element is there');return response;};
async function kk() { var p=document.querySelector('[aria-label="Message list"]').getElementsByClassName('s0OAm')[0];var itemlength=p.querySelectorAll('[class="ZtMcN"]').length; for(var i=0;i<=itemlength-1;i++){ var scroll=document.querySelector('[aria-label="Message list"]').getElementsByClassName('s0OAm')[0].querySelectorAll('[class="ZtMcN"]');scroll[scroll.length-1].scrollIntoView({behavior: "auto"});itemlength=scroll.length;p.querySelectorAll('[class="ZtMcN"]')[i].click(); var el= await waitForFoo('[id="read_ellipses_menu"]');el.click();var view=await waitForFoo('[aria-label="View"]');view.click();var vmsource=await waitForFoo('[aria-label="View message source"]');vmsource.click();var MS=await waitForFoo("[class='zNRsa allowTextSelection']"); var MSOURCE=MS.innerHTML;if(MSOURCE && MSOURCE.match("Authentication-Results")!=null){ var IP=MSOURCE.match("Authentication-Results: spf=(.*)")[1].match(/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/)[0];var SPF=MSOURCE.match("spf=(.*) \\(")[1] ;var DKIM=MSOURCE.match("dkim=(.*) \\(")[1] ;var string=IP+','+SPF+','+DKIM;MYDATA.push(string); $( "span:contains('Close')" ).click();} if(MSOURCE.match("Authentication-Results")==null){$( "span:contains('Close')" ).click();} }var sheet = document.createElement('style');sheet.innerHTML = ".ZtMcN {margin-bottom:1px}";document.body.appendChild(sheet);
addload(MYDATA.join('<br>'),0,6,42,'unblurred') ;navigator.clipboard.writeText(MYDATA.join('\n'));document.addEventListener('keydown', function(event){if(event.key === "Escape"){if(document.getElementById('unblurred').style['visibility']=='hidden'){navigator.clipboard.writeText(MYDATA.join('\n')).then(() => {console.log('sss')});document.getElementById('unblurred').style['visibility']='';} else if(document.getElementById('unblurred').style['visibility']==''){navigator.clipboard.writeText(MYDATA.join('\n')).then(() => {console.log('sss')});document.getElementById('unblurred').style['visibility']='hidden';}}})} kk();
}
